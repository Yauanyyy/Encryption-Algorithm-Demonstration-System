### 算法详细介绍

**历史背景：**
流密码的思想与一次性密钥流密切相关，早期的电报与机电加密设备就采用流式思想。20 世纪晚期随着计算机与通信的发展，产生了多种流密码设计：例如 RC4（由 Ron Rivest 于 1987 年设计）被广泛用于网络协议，但后来因偏差与实现问题被弃用。近年来，设计者如 Daniel J. Bernstein 提出的 Salsa20/ChaCha 家族（2005/2008 年）在性能与安全性上获得广泛认可，常与认证机制（如 Poly1305）配合使用形成 AEAD 模式（如 ChaCha20-Poly1305）。流密码被用于实时、低延迟与资源受限的场景（如网络流、嵌入式设备、加密隧道）。

**原理：**
流密码以按字节或按位产生伪随机密钥流（keystream）并与明文逐位（或逐字节）异或（XOR）来实现加密。流密码有基于同步（需要 IV/nonce）或异步（自洽的内部状态）的不同设计。

**流程：**

1. 初始化：使用密钥和（可选）随机数/初始向量 `IV` 初始化伪随机生成器（PRNG）或密码学伪随机数生成器（CSPRNG）。
2. 生成密钥流 `K`（按需生成任意长度）。
3. 对应字节（或位）计算密文 `C = P XOR K`。
4. 解密同样为 `P = C XOR K`（使用相同的密钥流）。

**安全性分析：**

流密码的安全性依赖于密钥流的不可预测性与唯一性：

- **密钥流重用（两次使用同一密钥流）会导致严重泄露**：若 C1 = P1 XOR K 且 C2 = P2 XOR K，则 C1 XOR C2 = P1 XOR P2，可能被用于恢复明文。
- **需要唯一的 IV/nonce** 来确保不同消息使用不同密钥流（例如 ChaCha20 需要唯一 nonce）。
- 早期流密码（如 RC4）在实际使用中暴露了偏差和实现问题，现代推荐使用经验证的算法（如 ChaCha20）并配合认证（AEAD，如 ChaCha20-Poly1305）。

流密码适合分组大小不固定或流式数据场景，但必须严格管理 nonce/IV 和密钥流的唯一性与完整性保护（使用 MAC 或 AEAD）。

